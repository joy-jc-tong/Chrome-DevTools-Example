<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>HAR Demo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: ui-sans-serif, system-ui, -apple-system; background:#f8fafc; padding:24px; }
    .card { background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:16px; max-width:860px; }
    .row { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:12px; }
    button { padding:8px 12px; border:1px solid #cbd5e1; border-radius:8px; background:#f1f5f9; cursor:pointer; }
    button:hover { background:#e2e8f0; }
    img { display:block; margin-top:8px; max-width:100%; }
    pre { background:#0b1020; color:#a8dadc; border-radius:8px; padding:12px; overflow:auto; }
  </style>
</head>
<body>
  <div class="card">
    <h1>HAR 範例產生器</h1>
    <div class="row">
      <button id="loadApi">XHR / Fetch</button>
      <button id="loadAssets">載入 JS/CSS</button>
      <button id="loadImages">載入圖片</button>
      <button id="clear">清空</button>
    </div>
    <div id="out"></div>
    <div id="imgs" style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;"></div>
    <h2>最近紀錄</h2>
    <pre id="log"></pre>
  </div>

  <script src="../base-path.js"></script>
  <script>
    const out = document.getElementById('out');
    const logEl = document.getElementById('log');
    const imgs = document.getElementById('imgs');
    const log = (m) => { logEl.textContent = (m + '\n' + logEl.textContent).slice(0,6000); console.log(m); };

    document.getElementById('clear').addEventListener('click', () => { out.innerHTML=''; imgs.innerHTML=''; logEl.textContent=''; });

    document.getElementById('loadApi').addEventListener('click', async () => {
      const basePath = getBasePath();
      const a = await fetch(basePath + 'fixtures/network/rt-a.json').then(r=>r.json()); log('api A: ' + JSON.stringify(a));
      const b = await fetch(basePath + 'fixtures/network/rt-b.json').then(r=>r.json()); log('api B: ' + JSON.stringify(b));
      const c = await fetch(basePath + 'fixtures/network/rt-c.json').then(r=>r.json()); log('api C: ' + JSON.stringify(c));
      out.innerHTML = '<p>API 載入完成（看 Network）</p>';
    });

    document.getElementById('loadAssets').addEventListener('click', () => {
      const basePath = getBasePath();
      const s = document.createElement('script'); s.src = basePath + 'fixtures/network/dummy.js'; document.body.appendChild(s);
      const l = document.createElement('link'); l.rel='stylesheet'; l.href = basePath + 'fixtures/network/dummy.css'; document.head.appendChild(l);
      log('assets requested');
    });

    document.getElementById('loadImages').addEventListener('click', () => {
      const basePath = getBasePath();
      imgs.innerHTML = '';
      [basePath + 'fixtures/network/img-1.png', basePath + 'fixtures/network/img-2.png', basePath + 'fixtures/network/img-3.png'].forEach(src=>{
        const img = new Image(); img.src = src; imgs.appendChild(img);
      });
      log('images requested');
    });
  </script>
</body>
</html>
